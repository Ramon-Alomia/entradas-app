<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin | Portal de Recepciones</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --bg:#f7f8fb; --card:#fff; --text:#111; --muted:#6b7280;
      --border:#e8ecf2; --accent:#0b5fff; --ok:#059669; --warn:#f59e0b; --danger:#e02424;
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);margin:0}
    header{background:var(--accent);color:#fff;padding:14px 18px;font-weight:600;display:flex;align-items:center;justify-content:space-between}
    header .right a{color:#fff;text-decoration:none;background:rgba(255,255,255,.15);padding:8px 12px;border-radius:10px}
    header .right a:hover{background:rgba(255,255,255,.25)}
    .wrap{max-width:1100px;margin:20px auto;padding:0 16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
    h1{font-size:20px;margin:0}
    h2{font-size:18px;margin:0 0 10px}
    label{display:block;font-size:13px;margin-top:8px}
    input,select{width:100%;padding:8px;border:1px solid #d7dbe3;border-radius:8px}
    button{background:var(--accent);color:#fff;border:0;border-radius:10px;padding:9px 14px;margin-top:10px;cursor:pointer}
    button.ok{background:var(--ok)}
    button.warn{background:var(--warn)}
    button.danger{background:var(--danger)}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border-bottom:1px solid #eef1f6;padding:8px;text-align:left;vertical-align:top}
    .muted{color:var(--muted)}
    .row{display:flex;gap:8px;align-items:end;flex-wrap:wrap}
    .hint{font-size:12px;color:var(--muted)}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
<header>
  <div>Administración</div>
  <div class="right">
    <a href="/logout" title="Cerrar sesión">Cerrar sesión</a>
  </div>
</header>

<div class="wrap">

  <!-- Acciones -->
  <div class="grid">
    <!-- Alta de usuario -->
    <div class="card">
      <h2>Alta de usuario</h2>
      <label>Usuario</label>
      <input id="u_username" placeholder="p. ej. User0001">

      <label>Rol</label>
      <select id="u_role">
        <option value="user">user</option>
        <option value="admin">admin</option>
      </select>

      <label>Contraseña (opcional; si no, se genera)</label>
      <input id="u_password" placeholder="(opcional)">

      <label>Almacenes (separados por coma)</label>
      <input id="u_whs" placeholder="IMSSVE16,HTLSDS">

      <div class="row">
        <button id="u_btn_create" class="ok">Crear usuario</button>
        <span id="u_msg" class="muted"></span>
      </div>
      <div class="hint">Sugerencia: puedes inactivar usuarios en la tabla de abajo si no deseas borrarlos.</div>
    </div>

    <!-- Alta/edición almacén -->
    <div class="card">
      <h2>Alta/edición de almacén</h2>
      <label>WhsCode</label>
      <input id="w_whscode" placeholder="Código de almacén">

      <label>CardCode</label>
      <input id="w_cardcode" placeholder="CardCode de proveedor (opcional)">

      <label>Descripción</label>
      <input id="w_whsdesc" placeholder="Descripción (opcional)">

      <div class="row">
        <button id="w_btn_save" class="ok">Guardar almacén</button>
        <span id="w_msg" class="muted"></span>
      </div>
      <div class="hint">Este formulario hace upsert: crea o actualiza si ya existe.</div>
    </div>
  </div>

  <!-- Listados -->
  <div class="grid" style="margin-top:16px">
    <!-- Usuarios -->
    <div class="card">
      <h2>Usuarios</h2>
      <table>
        <thead>
          <tr>
            <th>Usuario</th>
            <th>Rol</th>
            <th>Activo</th>
            <th>Whs</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody id="users_tbody"></tbody>
      </table>
      <div class="hint" style="margin-top:8px">
        Para “eliminar” un usuario, usa <b>Desactivar</b>. Si necesitas borrado físico, ahora también hay botón <b>Eliminar</b>.
      </div>
    </div>

    <!-- Almacenes -->
    <div class="card">
      <h2>Almacenes</h2>
      <table>
        <thead>
          <tr>
            <th>WhsCode</th>
            <th>CardCode</th>
            <th>Descripción</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody id="whs_tbody"></tbody>
      </table>
      <div class="hint" style="margin-top:8px">
        Si al eliminar obtienes error de conflicto, es porque hay registros relacionados (p. ej. en logs).
      </div>
    </div>
  </div>
</div>

<script src="/static/admin.js"></script>
</body>
</html>
